# shellcheck shell=bash


# Cookbook 1.15
# like watch command
# interval=3 loop.until.success cat ~/process_result
# example: loop 3 3s -- ping bing.com
# example: loop 3s -- ping bing.com
# example: loop ping bing.com
# more catchy name: keeptry
loop.until.success(){ 
    while :; do
        eval "$@" && return; 
        sleep "${INTERVAL:-3}"; 
    done 
}



# loop 3 cat ~/process_result
: <<DOCTEST
> time=3 INTERVAL=1 loop echo hi
hi
hi
hi
DOCTEST

loop(){
    local i IFS
    for i in $(seq "${time:-100}"); do
        eval "$*"
        sleep "${INTERVAL:-3}"
    done
}

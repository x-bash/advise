# shellcheck shell=bash
cp -r ./v0 ~/.x-cmd/advise/v0
cp -r ./v0.awk ~/.x-cmd/advise/v0.awk

# Section: Testcase for different awk
cross_env_test() {
    for i in debian centos bash ; do
        advise_log info "Testing : " "$i"
        docker run -it -v  ~/.x-cmd/:/root/.x-cmd/ -v "$(pwd)":/pd "${i}" bash -c ". ~/.x-cmd/xrc/latest && cd pd && . ./testcase/v0_test_awk"
    done
}

dbash() {
    docker run -it -v  ~/.x-cmd/:/root/.x-cmd/ -v "$(pwd)":/pd "bash:$1" \
        bash -c "printf \". ~/.x-cmd/xrc/latest\" >/root/.bashrc && cd pd && bash"
}

# EndSection

. ./testcase/v0_test_awk

# TODO: Optimize this testcase, use no '. ./testcase/v0_test', or can use x test <xxx>
printf "You can test cross awk env use: \n  . ./testcase/v0_test && cross_env_test\n"
printf "You can test cross bash env use: \n"

for i in 3 4 5 ; do
    printf "  . ./testcase/v0_test && dbash %s\n" "$i"
done
printf "\n"

# Section: for the interactive ui
xrc advise/v0
advise rm compt
advise compt "./testcase/test.json"
# EndSection

